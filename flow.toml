version = 1
name = "seq"

[flow]
deploy_task = "deploy"

[release]
default = "registry"
versioning = "calver"

[release.registry]
url = "https://myflow.sh"
package = "seq"
bins = ["seq", "seqd"]
default_bin = "seq"
token_env = "FLOW_REGISTRY_TOKEN"
latest = true

[[tasks]]
name = "build"
command = "sh ./cli/cpp/run.sh build"
description = "Build seq CLI/daemon (includes seqmem dylib)"

[[tasks]]
name = "release-registry-stage"
command = "sh -lc \"sh ./cli/cpp/run.sh build && mkdir -p target/release && cp ./cli/cpp/out/bin/seq ./cli/cpp/out/bin/seqd target/release/\""
description = "Build seq/seqd and stage binaries to target/release for registry publishing."

[[tasks]]
name = "release-registry-publish"
command = "sh -lc \"f release registry --no-build\""
description = "Publish staged seq/seqd binaries to myflow registry."

[[tasks]]
name = "daemon-restart"
command = "f daemon restart seqd"
description = "Restart seqd via Flow daemon manager"

[[tasks]]
name = "deploy"
command = "sh ./cli/cpp/run.sh deploy"
description = "Build seq and restart seqd"

[[tasks]]
name = "ch-mode"
command = "python3 tools/ch_mode.py \"$@\""
description = "Switch seq ClickHouse mode quickly: status|native|mirror|file|off."

[[tasks]]
name = "ch-mode-status"
command = "python3 tools/ch_mode.py status"
description = "Show current ClickHouse mode/env values from Flow env store."

[[tasks]]
name = "ch-mode-native"
command = "python3 tools/ch_mode.py native"
description = "Set SEQ_CH_MODE=native (native ClickHouse writer only)."

[[tasks]]
name = "ch-mode-mirror"
command = "python3 tools/ch_mode.py mirror"
description = "Set SEQ_CH_MODE=mirror (native writer + local JSON spool)."

[[tasks]]
name = "ch-mode-file"
command = "python3 tools/ch_mode.py file"
description = "Set SEQ_CH_MODE=file (local JSON spool only)."

[[tasks]]
name = "ch-mode-off"
command = "python3 tools/ch_mode.py off"
description = "Set SEQ_CH_MODE=off (disable ClickHouse emission)."

[[tasks]]
name = "seq-mem-sink-status"
command = "python3 tools/seq_mem_sink.py status --local-path ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl}"
description = "Show seq mem sink mode (file/remote/dual) and fallback queue status."

[[tasks]]
name = "seq-mem-sink-drain"
command = "python3 tools/seq_mem_sink.py drain --local-path ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --batch-size ${SEQ_MEM_REMOTE_DRAIN_BATCH_SIZE:-1000} --max-batches ${SEQ_MEM_REMOTE_DRAIN_MAX_BATCHES:-50}"
description = "Drain fallback queue into remote ClickHouse when remote is available."

[[tasks]]
name = "rl-capture-on"
command = "sh -lc \"f ch-mode file && f env set SEQ_CH_MEM_PATH=${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} && f env set SEQ_CH_LOG_PATH=${SEQ_CH_LOG_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_trace.jsonl} && f ch-mode-status\""
description = "Enable low-latency local RL trace capture (file mode + local spool paths)."

[[tasks]]
name = "rl-capture-remote-on"
command = "python3 tools/seq_remote_on.py"
description = "Enable remote-first RL capture: seqd native CH + Python writers via remote HTTP sink."

[[tasks]]
name = "rl-signal-tail"
command = "sh -lc \"tail -f ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} | python3 tools/rl_signal_filter.py\""
description = "Follow only high-signal seq events for RL (stdin filter over seq_mem.jsonl)."

[[tasks]]
name = "rl-signal-summary"
command = "python3 tools/rl_signal_filter.py --file ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --summary --last ${LAST:-5000}"
description = "Summarize high-signal event density from recent seq_mem rows."

[[tasks]]
name = "rl-signal-summary-agent-qa"
command = "python3 tools/rl_signal_filter.py --file ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --summary --include-agent-qa --last ${LAST:-5000}"
description = "Summarize router + agent.qa high-signal events from recent seq_mem rows."

[[tasks]]
name = "rl-next-run-prep"
command = "python3 tools/rl_next_run_prep.py --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --router-out ${ROUTER_SIGNAL_OUT:-$HOME/repos/laude-institute/harbor/data/router_signal/latest} --kar-out ${KAR_SIGNAL_OUT:-$HOME/repos/laude-institute/harbor/data/kar_signal/latest} --report ${SEQ_RL_NEXT_RUN_REPORT:-$HOME/.local/state/seq/rl_next_run_prep_report.json}"
description = "Run strict health + dataset export/audit gates and emit a single next-run readiness report."

[[tasks]]
name = "rl-next-run-report"
command = "sh -lc \"cat ${SEQ_RL_NEXT_RUN_REPORT:-$HOME/.local/state/seq/rl_next_run_prep_report.json}\""
description = "Show latest RL next-run readiness report."

[[tasks]]
name = "router-signal-emit-sample"
command = "python3 tools/router_signal_emit_sample.py"
description = "Emit sample flow.router decision/outcome rows into seq_mem for pipeline smoke tests."

[[tasks]]
name = "router-signal-export"
command = "python3 tools/router_signal_export.py --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --output-dir ${ROUTER_SIGNAL_OUT:-$HOME/repos/laude-institute/harbor/data/router_signal/latest} --max-age-hours ${ROUTER_SIGNAL_MAX_AGE_HOURS:-168}"
description = "Export joined flow.router decision/outcome dataset (train/val/test + summary)."

[[tasks]]
name = "router-signal-audit"
command = "python3 tools/router_signal_audit.py --summary ${ROUTER_SIGNAL_SUMMARY:-$HOME/repos/laude-institute/harbor/data/router_signal/latest/summary.json} --min-decisions ${ROUTER_SIGNAL_MIN_DECISIONS:-500} --min-joined ${ROUTER_SIGNAL_MIN_JOINED:-400} --min-link-rate ${ROUTER_SIGNAL_MIN_LINK_RATE:-0.80} --max-task-dominance ${ROUTER_SIGNAL_MAX_TASK_DOMINANCE:-0.55} --min-overrides ${ROUTER_SIGNAL_MIN_OVERRIDES:-20} --min-failureish ${ROUTER_SIGNAL_MIN_FAILUREISH:-60}"
description = "Gate router signal quality before RL training (volume/linkage/balance/overrides)."

[[tasks]]
name = "kar-signal-capture-preflight"
command = "python3 tools/kar_signal_capture.py preflight"
description = "Check Kar RL signal capture prerequisites."

[[tasks]]
name = "kar-signal-capture-on"
command = "python3 tools/kar_signal_capture.py start"
description = "Start Kar RL signal capture daemon (intent/outcome/override derivation)."

[[tasks]]
name = "kar-signal-capture-off"
command = "python3 tools/kar_signal_capture.py stop"
description = "Stop Kar RL signal capture daemon."

[[tasks]]
name = "kar-signal-capture-status"
command = "python3 tools/kar_signal_capture.py status"
description = "Show Kar RL signal capture daemon status."

[[tasks]]
name = "kar-signal-capture-once"
command = "python3 tools/kar_signal_capture.py once"
description = "Run one Kar signal derivation pass from current seq_mem offset."

[[tasks]]
name = "kar-signal-backfill"
command = "python3 tools/kar_signal_capture.py once --reset-state"
description = "Backfill Kar signal derivation from start of current seq_mem file."

[[tasks]]
name = "kar-signal-capture-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_KAR_SIGNAL_LOG:-$HOME/code/seq/cli/cpp/out/logs/kar_signal_capture.log}\""
description = "Tail Kar signal capture daemon logs."

[[tasks]]
name = "kar-signal-export"
command = "python3 tools/kar_signal_export.py --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --output-dir ${KAR_SIGNAL_OUT:-$HOME/repos/laude-institute/harbor/data/kar_signal/latest} --max-age-hours ${KAR_SIGNAL_MAX_AGE_HOURS:-168}"
description = "Export Kar intent/outcome/override dataset (train/val/test + summary)."

[[tasks]]
name = "kar-signal-export-all"
command = "python3 tools/kar_signal_export.py --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} --output-dir ${KAR_SIGNAL_OUT:-$HOME/repos/laude-institute/harbor/data/kar_signal/latest} --max-age-hours 999999"
description = "Export Kar signal dataset using full available seq_mem history."

[[tasks]]
name = "kar-signal-audit"
command = "python3 tools/kar_signal_audit.py --summary ${KAR_SIGNAL_SUMMARY:-$HOME/repos/laude-institute/harbor/data/kar_signal/latest/summary.json} --min-intents ${KAR_SIGNAL_MIN_INTENTS:-300} --min-joined ${KAR_SIGNAL_MIN_JOINED:-250} --min-link-rate ${KAR_SIGNAL_MIN_LINK_RATE:-0.80} --max-action-dominance ${KAR_SIGNAL_MAX_ACTION_DOMINANCE:-0.65} --min-overrides ${KAR_SIGNAL_MIN_OVERRIDES:-10} --min-failureish ${KAR_SIGNAL_MIN_FAILUREISH:-30}"
description = "Gate Kar signal quality before RL tuning."

[[tasks]]
name = "seq-signal-watchdog-preflight"
command = "python3 tools/seq_signal_watchdog.py preflight"
description = "Check capture watchdog prerequisites."

[[tasks]]
name = "seq-signal-watchdog-on"
command = "python3 tools/seq_signal_watchdog.py start"
description = "Start periodic data-flow watchdog (health + validity checks)."

[[tasks]]
name = "seq-signal-watchdog-off"
command = "python3 tools/seq_signal_watchdog.py stop"
description = "Stop data-flow watchdog daemon."

[[tasks]]
name = "seq-signal-watchdog-status"
command = "python3 tools/seq_signal_watchdog.py status"
description = "Show data-flow watchdog daemon status."

[[tasks]]
name = "seq-signal-watchdog-once"
command = "python3 tools/seq_signal_watchdog.py once"
description = "Run one health/validity check now."

[[tasks]]
name = "seq-signal-watchdog-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_SIGNAL_WATCHDOG_LOG:-$HOME/code/seq/cli/cpp/out/logs/signal_watchdog.log}\""
description = "Tail data-flow watchdog logs."

[[tasks]]
name = "seq-signal-watchdog-report"
command = "sh -lc \"cat ${SEQ_SIGNAL_WATCHDOG_REPORT:-$HOME/.local/state/seq/signal_watchdog_report.json}\""
description = "Show latest watchdog report JSON."

[[tasks]]
name = "seq-health"
command = "python3 tools/seq_health.py --lookback-hours ${SEQ_HEALTH_LOOKBACK_HOURS:-24} --tail-bytes ${SEQ_HEALTH_TAIL_BYTES:-20971520} --min-next-type ${SEQ_HEALTH_MIN_NEXT_TYPE:-1} --min-kar-intent ${SEQ_HEALTH_MIN_KAR_INTENT:-0} --min-kar-outcome ${SEQ_HEALTH_MIN_KAR_OUTCOME:-0} --min-agent-qa ${SEQ_HEALTH_MIN_AGENT_QA:-1} --min-kar-link-rate ${SEQ_HEALTH_MIN_KAR_LINK_RATE:-0.75} --watchdog-max-age-minutes ${SEQ_HEALTH_WATCHDOG_MAX_AGE_MINUTES:-30} --launchd-label ${SEQD_LAUNCHD_LABEL:-dev.nikiv.seqd} --repair-seqd --repair-wait-s ${SEQ_HEALTH_REPAIR_WAIT_S:-1.0} --report-out ${SEQ_HEALTH_REPORT:-$HOME/.local/state/seq/seq_health_report.json}"
description = "Strict end-to-end seq capture health check for RL training readiness."

[[tasks]]
name = "seq-health-relaxed"
command = "python3 tools/seq_health.py --no-strict --lookback-hours ${SEQ_HEALTH_LOOKBACK_HOURS:-24} --tail-bytes ${SEQ_HEALTH_TAIL_BYTES:-20971520} --min-next-type ${SEQ_HEALTH_MIN_NEXT_TYPE:-1} --min-kar-intent ${SEQ_HEALTH_MIN_KAR_INTENT:-0} --min-kar-outcome ${SEQ_HEALTH_MIN_KAR_OUTCOME:-0} --min-agent-qa ${SEQ_HEALTH_MIN_AGENT_QA:-1} --min-kar-link-rate ${SEQ_HEALTH_MIN_KAR_LINK_RATE:-0.75} --watchdog-max-age-minutes ${SEQ_HEALTH_WATCHDOG_MAX_AGE_MINUTES:-30} --launchd-label ${SEQD_LAUNCHD_LABEL:-dev.nikiv.seqd} --repair-seqd --repair-wait-s ${SEQ_HEALTH_REPAIR_WAIT_S:-1.0} --report-out ${SEQ_HEALTH_REPORT:-$HOME/.local/state/seq/seq_health_report.json}"
description = "Health check with signal coverage gates downgraded to warnings."

[[tasks]]
name = "seq-health-report"
command = "sh -lc \"cat ${SEQ_HEALTH_REPORT:-$HOME/.local/state/seq/seq_health_report.json}\""
description = "Show latest seq-health report JSON."


[[tasks]]
name = "agent-qa-capture-on"
command = "python3 tools/agent_qa_ingest.py start"
description = "Start always-on Claude/Codex Q/A capture into seq_mem (background daemon)."

[[tasks]]
name = "agent-qa-capture-on-backfill"
command = "python3 tools/agent_qa_ingest.py start --backfill --reset-state"
description = "Start Q/A capture and backfill historical session logs once."

[[tasks]]
name = "agent-qa-capture-off"
command = "python3 tools/agent_qa_ingest.py stop"
description = "Stop background Claude/Codex Q/A capture daemon."

[[tasks]]
name = "agent-qa-capture-status"
command = "python3 tools/agent_qa_ingest.py status"
description = "Show background Q/A capture daemon status."

[[tasks]]
name = "agent-qa-capture-once"
command = "python3 tools/agent_qa_ingest.py once"
description = "Run one Q/A ingest scan pass (no daemon)."

[[tasks]]
name = "agent-qa-capture-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_AGENT_QA_LOG:-$HOME/code/seq/cli/cpp/out/logs/agent_qa_ingest.log}\""
description = "Tail Q/A capture daemon logs."

[[tasks]]
name = "next-type-capture-setup"
command = "sh -lc \"set -e; python3 tools/next_type_tap_build.py; python3 tools/next_type_key_capture_daemon.py preflight; python3 tools/next_type_key_capture_daemon.py start; python3 tools/next_type_key_capture_daemon.py status\""
description = "Build + preflight + start always-on key capture (headless tap -> seq mem)."

[[tasks]]
name = "next-type-capture-preflight"
command = "sh -lc \"set -e; python3 tools/next_type_tap_build.py; python3 tools/next_type_key_capture_daemon.py preflight\""
description = "Check key capture prerequisites (tap binary + paths + ingest helper)."

[[tasks]]
name = "next-type-capture-on"
command = "python3 tools/next_type_key_capture_daemon.py start"
description = "Start background key capture daemon."

[[tasks]]
name = "next-type-tap-build"
command = "python3 tools/next_type_tap_build.py"
description = "Build headless key tap binary (no GUI window)."

[[tasks]]
name = "next-type-capture-off"
command = "python3 tools/next_type_key_capture_daemon.py stop"
description = "Stop background key capture daemon."

[[tasks]]
name = "next-type-capture-status"
command = "python3 tools/next_type_key_capture_daemon.py status"
description = "Show key capture daemon status."

[[tasks]]
name = "next-type-capture-once"
command = "python3 tools/next_type_key_capture_daemon.py once"
description = "Process current key tap log from saved offset and exit."

[[tasks]]
name = "next-type-capture-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_NEXT_TYPE_LOG:-$HOME/code/seq/cli/cpp/out/logs/next_type_key_capture.log}\""
description = "Tail key capture daemon logs."

[[tasks]]
name = "next-type-predictor-preflight"
command = "python3 tools/next_type_predictor_daemon.py preflight"
description = "Check next-type predictor prerequisites and writable paths."

[[tasks]]
name = "next-type-predictor-on"
command = "python3 tools/next_type_predictor_daemon.py start"
description = "Start background next-type predictor daemon."

[[tasks]]
name = "next-type-predictor-off"
command = "python3 tools/next_type_predictor_daemon.py stop"
description = "Stop background next-type predictor daemon."

[[tasks]]
name = "next-type-predictor-status"
command = "python3 tools/next_type_predictor_daemon.py status"
description = "Show next-type predictor daemon status + latest suggestion."

[[tasks]]
name = "next-type-predictor-once"
command = "python3 tools/next_type_predictor_daemon.py once"
description = "Run one predictor pass over unread seq_mem rows and exit."

[[tasks]]
name = "next-type-predictor-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_NEXT_TYPE_PREDICTOR_LOG:-$HOME/code/seq/cli/cpp/out/logs/next_type_predictor.log}\""
description = "Tail next-type predictor daemon logs."

[[tasks]]
name = "next-type-accept"
command = "python3 tools/next_type_accept.py --state ${SEQ_NEXT_TYPE_PREDICTOR_STATE:-$HOME/.local/state/seq/next_type_predictor_state.json} --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl}"
description = "Accept latest next-type suggestion (hotkey-safe, low-latency seq RPC)."

[[tasks]]
name = "next-type-accept-dry"
command = "python3 tools/next_type_accept.py --dry-run --state ${SEQ_NEXT_TYPE_PREDICTOR_STATE:-$HOME/.local/state/seq/next_type_predictor_state.json} --seq-mem ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl}"
description = "Validate latest next-type suggestion without typing it."

[[tasks]]
name = "next-type-fast-on"
command = "sh -lc \"set -e; f seq-harbor-run; f next-type-predictor-status\""
description = "Bring up always-on capture + prediction loop for OS-level next-type completion."

[[tasks]]
name = "next-type-data-collect-on"
command = "sh -lc \"set -e; f seq-harbor-run; f next-type-context-probe-on; f next-type-context-probe-status\""
description = "Start continuous capture for next-type training data (keystrokes + context)."

[[tasks]]
name = "next-type-data-collect-off"
command = "sh -lc \"set -e; f next-type-context-probe-off || true; f seq-harbor-stop\""
description = "Stop continuous next-type training data capture."

[[tasks]]
name = "next-type-context-probe-preflight"
command = "python3 tools/next_type_context_probe.py preflight"
description = "Check context probe prerequisites (osascript + accessibility)."

[[tasks]]
name = "next-type-context-probe-on"
command = "python3 tools/next_type_context_probe.py start"
description = "Start background Zed context probe daemon."

[[tasks]]
name = "next-type-context-probe-off"
command = "python3 tools/next_type_context_probe.py stop"
description = "Stop background Zed context probe daemon."

[[tasks]]
name = "next-type-context-probe-status"
command = "python3 tools/next_type_context_probe.py status"
description = "Show Zed context probe daemon status."

[[tasks]]
name = "next-type-context-probe-once"
command = "python3 tools/next_type_context_probe.py once"
description = "Run one context probe pass and exit."

[[tasks]]
name = "next-type-context-probe-logs"
command = "sh -lc \"tail -n 120 -f ${SEQ_NEXT_TYPE_CONTEXT_LOG:-$HOME/code/seq/cli/cpp/out/logs/next_type_context_probe.log}\""
description = "Tail context probe daemon logs."

[[tasks]]
name = "next-type-phrase-build"
command = "python3 tools/next_type_phrase_builder.py"
description = "Build (context, phrase) training pairs from seq_mem text bursts + context events."

[[tasks]]
name = "next-type-dataset-export"
command = "python3 tools/next_type_dataset_export.py --stats"
description = "Export filtered training dataset with train/val/test splits for prime-rl."

[[tasks]]
name = "next-type-dataset-stage-prime"
command = "python3 tools/next_type_dataset_stage_prime.py"
description = "Copy combined next-type dataset into prime-rl environment data path."

[[tasks]]
name = "next-type-dataset-build-and-stage"
command = "sh -lc \"set -euo pipefail; f next-type-phrase-build; f next-type-dataset-export; f next-type-dataset-stage-prime\""
description = "Build phrase pairs, export splits, and stage dataset for prime-rl env."

[[tasks]]
name = "next-type-dataset-stats"
command = "sh -lc \"cat ${SEQ_NEXT_TYPE_DATASET_DIR:-$HOME/.local/state/seq/next_type_dataset}/manifest.json 2>/dev/null || echo 'no dataset manifest found â€” run next-type-dataset-export first'\""
description = "Show next-type dataset summary (counts per language, per project, per split)."

[[tasks]]
name = "seq-harbor-preflight"
command = "sh -lc \"set -e; python3 tools/next_type_tap_build.py; python3 tools/next_type_key_capture_daemon.py preflight; python3 tools/next_type_predictor_daemon.py preflight; python3 tools/kar_signal_capture.py preflight; python3 tools/seq_signal_watchdog.py preflight; python3 tools/ch_mode.py status; python3 tools/agent_qa_ingest.py status || true\""
description = "Preflight high-signal capture + prediction stack (keystrokes + predictor + Kar + watchdog + seq mode + agent Q/A)."

[[tasks]]
name = "seq-harbor-install"
command = "sh -lc \"set -e; python3 tools/ch_mode.py file; python3 tools/next_type_tap_build.py; python3 tools/next_type_key_capture_daemon.py preflight; python3 tools/seq_capture_launchd.py install --service all\""
description = "Prepare seq for low-latency RL capture and install launchd supervision for capture daemons."

[[tasks]]
name = "seq-harbor-install-remote"
command = "python3 tools/seq_remote_on.py --install"
description = "Install remote-first capture (Python writers -> remote ClickHouse, local file only as fallback queue)."

[[tasks]]
name = "seq-harbor-run"
command = "sh -lc \"set -e; python3 tools/seq_capture_launchd.py restart --service all; python3 tools/seq_capture_launchd.py status --service all\""
description = "Start/restart supervised continuous capture + prediction via launchd (keystrokes + predictor + Kar + agent Q/A + watchdog)."

[[tasks]]
name = "seq-harbor-stop"
command = "sh -lc \"set -e; python3 tools/seq_capture_launchd.py stop --service all\""
description = "Stop launchd-supervised capture daemons."

[[tasks]]
name = "seq-harbor-status"
command = "sh -lc \"python3 tools/seq_capture_launchd.py status --service all || true; echo '---'; python3 tools/next_type_key_capture_daemon.py status || true; echo '---'; python3 tools/next_type_predictor_daemon.py status || true; echo '---'; python3 tools/kar_signal_capture.py status || true; echo '---'; python3 tools/agent_qa_ingest.py status || true; echo '---'; python3 tools/seq_signal_watchdog.py status || true; echo '---'; python3 tools/ch_mode.py status\""
description = "Show launchd + daemon + prediction + ClickHouse capture status."

[[tasks]]
name = "seq-harbor-logs"
command = "sh -lc \"mkdir -p $HOME/code/seq/cli/cpp/out/logs; touch $HOME/code/seq/cli/cpp/out/logs/next_type.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/next_type_predictor.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/kar_signal.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/agent_qa.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/watchdog.launchd.stderr.log; tail -n 120 -f $HOME/code/seq/cli/cpp/out/logs/next_type.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/next_type_predictor.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/kar_signal.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/agent_qa.launchd.stderr.log $HOME/code/seq/cli/cpp/out/logs/watchdog.launchd.stderr.log\""
description = "Tail launchd capture logs (next_type + predictor + Kar + agent Q/A + watchdog)."

[[tasks]]
name = "seq-capture-launchd-install"
command = "python3 tools/seq_capture_launchd.py install --service all"
description = "Install launchd supervision for all seq capture daemons."

[[tasks]]
name = "seq-capture-launchd-restart"
command = "python3 tools/seq_capture_launchd.py restart --service all"
description = "Restart launchd-supervised seq capture daemons."

[[tasks]]
name = "seq-capture-launchd-stop"
command = "python3 tools/seq_capture_launchd.py stop --service all"
description = "Stop launchd-supervised seq capture daemons."

[[tasks]]
name = "seq-capture-launchd-status"
command = "python3 tools/seq_capture_launchd.py status --service all"
description = "Show launchd status for all capture daemons."

[[tasks]]
name = "seq-capture-launchd-uninstall"
command = "python3 tools/seq_capture_launchd.py uninstall --service all"
description = "Remove launchd supervision plists for capture daemons."

[[tasks]]
name = "seq-checkpoints-list"
command = "bash -lc 'ls -1dt ${SEQ_SIGNAL_WATCHDOG_SNAPSHOT_DIR:-$HOME/.local/state/seq/checkpoints}/checkpoint_* 2>/dev/null | grep \"^/\" | head -n ${N:-20}'"
description = "List recent watchdog capture checkpoints."

[[tasks]]
name = "seq-checkpoints-latest"
command = "bash -lc 'latest=$(ls -1dt ${SEQ_SIGNAL_WATCHDOG_SNAPSHOT_DIR:-$HOME/.local/state/seq/checkpoints}/checkpoint_* 2>/dev/null | grep \"^/\" | head -n 1); [ -n \"$latest\" ] && [ -f \"$latest/manifest.json\" ] && cat \"$latest/manifest.json\" || echo \"No checkpoints found.\"'"
description = "Show manifest for the latest watchdog checkpoint."

[[tasks]]
name = "seq-checkpoint-now"
command = "python3 tools/seq_signal_watchdog.py once --snapshot-enabled --snapshot-interval-minutes 1 --snapshot-keep ${KEEP:-120}"
description = "Force a watchdog pass and create a fresh checkpoint (if >=1 min since last snapshot)."

[[tasks]]
name = "seq-checkpoint-now-and-delta"
command = "sh -lc \"set -e; f seq-checkpoint-now; f seq-checkpoints-delta\""
description = "Take a checkpoint now, then show delta vs the previous checkpoint."

[[tasks]]
name = "seq-checkpoints-delta"
command = "python3 tools/seq_checkpoint_delta.py --top ${TOP:-20}"
description = "Show data delta between the two latest checkpoints (file growth + event counts)."

[[tasks]]
name = "seq-checkpoints-delta-json"
command = "python3 tools/seq_checkpoint_delta.py --json --top ${TOP:-20}"
description = "Same as seq-checkpoints-delta but JSON output."

[[tasks]]
name = "seq-checkpoints-delta-watch"
command = "python3 tools/seq_checkpoint_delta.py --watch --interval-s ${INTERVAL_S:-15} --top ${TOP:-20}"
description = "Continuously print new checkpoint deltas as they arrive."

[[tasks]]
name = "app-state"
command = "sh -lc \"/Users/nikiv/code/seq/cli/cpp/out/bin/seq app-state\""
description = "Dump seqd cached frontmost/previous app (avoid PATH conflict with /usr/bin/seq)"

[[tasks]]
name = "accessibility-prompt"
command = "sh -lc \"/Users/nikiv/code/seq/cli/cpp/out/bin/seq accessibility-prompt\""
description = "Trigger Accessibility permission prompt for seq (needed for Cmd-Tab injection)"

[[tasks]]
name = "test"
command = "sh ./cli/cpp/run.sh test"
description = "Perf smoke tests for seqd + memory engine"

[[tasks]]
name = "watch-open-app-toggle"
command = "sh -lc \"tail -f $HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl | rg --line-buffered 'cli\\\\.open_app_toggle\\\\.action'\""
description = "Tail open-app-toggle decisions (cli.open_app_toggle.action) from seq_mem.jsonl"

[[tasks]]
name = "watch-open-app-toggle-debug"
command = "sh -lc \"tail -f $HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl | rg --line-buffered 'cli\\\\.open_app_toggle\\\\.action|seqd\\\\.open_app_toggle\\\\.diag|app\\\\.activate'\""
description = "Tail app-toggle decisions + daemon diag + app.activate from seq_mem.jsonl"

[[tasks]]
name = "watch-open-app-toggle-rule"
command = "sh -lc \"tail -f $HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl | python3 tools/open_app_toggle_rule.py\""
description = "Rule: for each decision=open_prev, expect app.activate(prev) soon after"

[[tasks]]
name = "km-parallel-scout"
command = "python3 tools/km_parallel_scout.py --limit 50"
description = "Scan kar/config.ts + KM macro DB for macros that could benefit from seq parallel execution"

[[tasks]]
name = "import-km-arc"
command = "python3 tools/import_km_arc_macros.py"
description = "Import KM arc:* macros into seq.macros.local.yaml (Spaces menu + keystrokes)"

[[tasks]]
name = "import-km-arc-deploy"
command = "sh -lc \"python3 tools/import_km_arc_macros.py && sh ./cli/cpp/run.sh deploy\""
description = "Import KM arc:* macros then deploy (restart seqd)"

[[tasks]]
name = "dump-open-app-toggle-debug"
command = "sh -lc \"/Users/nikiv/code/seq/cli/cpp/out/bin/seq app-state; echo '---'; tail -n 200 $HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl | rg 'cli\\\\.open_app_toggle\\\\.action|seqd\\\\.open_app_toggle\\\\.diag|app\\\\.activate' | tail -n 80\""
description = "Snapshot current app-state + recent open-app-toggle related events"

[[tasks]]
name = "tail-logs"
command = "python3 tools/tail_all_logs.py --last 200"
description = "Tail both seq_trace.jsonl + seq_mem.jsonl (human readable)"

[[tasks]]
name = "tail-logs-json"
command = "python3 tools/tail_all_logs.py --last 200 --json"
description = "Tail both logs as JSON objects (easy to paste)"

[[tasks]]
name = "watch-logs"
command = "sh -lc \"echo 'READY watch-logs'; python3 tools/tail_all_logs.py --last 0 --follow\""
description = "Follow both logs from now (starts empty; human readable)"

[[tasks]]
name = "watch-logs-toggle"
command = "sh -lc \"echo 'READY watch-logs-toggle'; python3 tools/tail_all_logs.py --last 0 --follow --grep 'open_app_toggle|app\\\\.activate'\""
description = "Follow app toggle + app.activate from now (starts empty)"

[[tasks]]
name = "watch-logs-json"
command = "sh -lc \"echo 'READY watch-logs-json'; python3 tools/tail_all_logs.py --last 0 --follow --json\""
description = "Follow both logs from now as JSON objects (starts empty; pasteable)"

[[tasks]]
name = "watch-logs-toggle-json"
command = "sh -lc \"echo 'READY watch-logs-toggle-json'; python3 tools/tail_all_logs.py --last 0 --follow --json --grep 'open_app_toggle|app\\\\.activate'\""
description = "Follow app toggle + app.activate from now as JSON objects (starts empty)"

[[tasks]]
name = "watch-arc"
command = "sh -lc \"echo 'READY watch-arc'; python3 tools/tail_all_logs.py --last 0 --follow --grep 'seqd\\\\.run|menu\\\\.select|AX_(STATUS|PROMPT)|open_url\\\\.activate_app'\""
description = "Follow Arc-related automation (seqd.run + menu.select + open_url.activate_app)"

[[tasks]]
name = "watch-arc-json"
command = "sh -lc \"echo 'READY watch-arc-json'; python3 tools/tail_all_logs.py --last 0 --follow --json --grep 'seqd\\\\.run|menu\\\\.select|AX_(STATUS|PROMPT)|open_url\\\\.activate_app'\""
description = "Follow Arc-related automation as JSON objects (pasteable)"

[[tasks]]
name = "scrape-health"
command = "sh -lc \"curl -fsS ${SEQ_SCRAPER_BASE_URL:-http://127.0.0.1:7444}/health | python3 -m json.tool\""
description = "Check scraper daemon/API health (used by teach commands)."

[[tasks]]
name = "teach-dep"
command = "python3 tools/teach_deps.py dep \"$@\""
description = "Generate a dependency skill by scraping official docs via the always-on scraper."

[[tasks]]
name = "teach-auto"
command = "python3 tools/teach_deps.py auto \"$@\""
description = "Auto-discover dependencies in this repo and generate skills using scraper jobs."

[[tasks]]
name = "teach-url"
command = "python3 tools/teach_deps.py url \"$@\""
description = "Generate a skill from one or more URLs via scraper jobs."

[[tasks]]
name = "teach-logs"
command = "sh -lc \"tail -f ${SEQ_CH_MEM_PATH:-$HOME/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl} | rg --line-buffered 'teach\\\\.'\""
description = "Tail teach.* scraper skill events from seq_mem.jsonl."

[[tasks]]
name = "kar-uc-build-bridge"
command = "sh -lc \"cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && make build-bridge-release\""
description = "Build release seq-user-command-bridge in Karabiner user-command receiver repo."

[[tasks]]
name = "kar-uc-rebuild-restart"
command = "sh -lc \"cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && make build-bridge-release && cd $HOME/code/seq && python3 tools/kar_uc_launchd.py restart\""
description = "Always rebuild release bridge and kickstart launchd agent."

[[tasks]]
name = "kar-uc-run-bridge"
command = "sh -lc \"export SEQ_USER_COMMAND_SOCKET_PATH=\\\"/Library/Application Support/org.pqrs/tmp/user/$(id -u)/user_command_receiver.sock\\\"; export SEQ_BRIDGE_HIGH_PRIORITY=${SEQ_BRIDGE_HIGH_PRIORITY:-1}; cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && make run-bridge-release\""
description = "Run release seq-user-command-bridge (high-priority by default) for low-latency forwarding."

[[tasks]]
name = "kar-uc-run-bridge-debug"
command = "sh -lc \"export SEQ_USER_COMMAND_SOCKET_PATH=\\\"/Library/Application Support/org.pqrs/tmp/user/$(id -u)/user_command_receiver.sock\\\"; cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && make run-bridge\""
description = "Run debug seq-user-command-bridge (swift run) for development."

[[tasks]]
name = "kar-uc-launchd-install"
command = "python3 tools/kar_uc_launchd.py install --build-if-missing"
description = "Install+load always-on launchd agent for release seq-user-command-bridge."

[[tasks]]
name = "kar-uc-launchd-restart"
command = "python3 tools/kar_uc_launchd.py restart --build-if-missing"
description = "Restart launchd bridge agent after rebuilding release binary."

[[tasks]]
name = "kar-uc-launchd-stop"
command = "python3 tools/kar_uc_launchd.py stop"
description = "Stop launchd bridge agent."

[[tasks]]
name = "kar-uc-launchd-status"
command = "python3 tools/kar_uc_launchd.py status"
description = "Show launchd bridge agent status."

[[tasks]]
name = "kar-uc-launchd-uninstall"
command = "python3 tools/kar_uc_launchd.py uninstall"
description = "Unload and remove launchd bridge agent plist."

[[tasks]]
name = "kar-uc-launchd-logs"
command = "sh -lc \"tail -n 80 -f $HOME/code/seq/cli/cpp/out/logs/kar_uc_bridge.stderr.log\""
description = "Tail bridge launchd stderr log."

[[tasks]]
name = "kar-uc-send"
command = "python3 tools/kar_user_command_send.py \"$@\""
description = "Send a JSON payload to Karabiner user-command receiver socket."

[[tasks]]
name = "kar-uc-smoke"
command = "python3 tools/kar_user_command_smoke.py \"$@\""
description = "Smoke test bridge forwarding with a mock seqd dgram socket."

[[tasks]]
name = "kar-uc-bench"
command = "python3 tools/kar_user_command_latency_bench.py \"$@\""
description = "Benchmark direct seqd dgram vs send_user_command bridge overhead."

[[tasks]]
name = "kar-uc-e2e-ab"
command = "python3 tools/kar_user_command_e2e_ab.py \"$@\""
description = "A/B benchmark full software flow: legacy shell path vs send_user_command path."

[[tasks]]
name = "kar-uc-floor-check"
command = "python3 tools/kar_user_command_floor_check.py \"$@\""
description = "Clean-room floor harness: system gate + bridge restart + repeated E2E + transport summary."

[[tasks]]
name = "kar-uc-system-check"
command = "sh -lc \"cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && make run-system-check\""
description = "Check system pressure and readiness for clean latency testing (READY/NOT_READY verdict)."

[[tasks]]
name = "kar-uc-system-check-report"
command = "sh -lc \"cd $HOME/repos/pqrs-org/Karabiner-Elements-user-command-receiver && swift run kar-uc-system-check || true\""
description = "Report system pressure/readiness without failing task status."

[[tasks]]
name = "zvec-server"
command = "sh ./cli/zvec/run.sh start"
description = "Start zvec vector search server (HTTP :8900)"
daemon = true

[[tasks]]
name = "mac-kg-index"
command = "python3 tools/mac_knowledge.py index \"$@\""
description = "Index local macOS files/metadata into seq mac knowledge DB (SQLite + FTS, optional zvec upsert)."

[[tasks]]
name = "mac-kg-watch"
command = "python3 tools/mac_knowledge.py watch \"$@\""
description = "Continuously refresh mac knowledge DB with fast incremental scans."

[[tasks]]
name = "mac-kg-search"
command = "python3 tools/mac_knowledge.py search \"$@\""
description = "Search local mac knowledge DB (lexical, optional --vector via zvec)."

[[tasks]]
name = "mac-kg-who-watches"
command = "python3 tools/mac_knowledge.py who-watches \"$@\""
description = "Show inferred watchers/dependencies for a file path (e.g. kar config.ts)."

[[tasks]]
name = "mac-kg-stats"
command = "python3 tools/mac_knowledge.py stats \"$@\""
description = "Show mac knowledge DB stats."

[storage]
provider = "myflow.sh"

[[storage.envs]]
name = "local"
description = "Everruns->Maple dual-ingest configuration for seq bridge"
variables = [
  { key = "SEQ_CH_MODE", default = "file" },
  { key = "SEQ_CH_HOST", default = "127.0.0.1" },
  { key = "SEQ_CH_PORT", default = "9000" },
  { key = "SEQ_CH_HTTP_PORT", default = "8123" },
  { key = "SEQ_CH_DATABASE", default = "seq" },
  { key = "SEQ_CH_MEM_PATH" },
  { key = "SEQ_CH_LOG_PATH" },
  { key = "SEQ_MEM_SINK_MODE", default = "auto" },
  { key = "SEQ_MEM_REMOTE_URL" },
  { key = "SEQ_MEM_REMOTE_DB", default = "seq" },
  { key = "SEQ_MEM_REMOTE_TABLE", default = "mem_events" },
  { key = "SEQ_MEM_REMOTE_USER" },
  { key = "SEQ_MEM_REMOTE_PASSWORD" },
  { key = "SEQ_MEM_REMOTE_TIMEOUT_S", default = "2.5" },
  { key = "SEQ_MEM_REMOTE_VERIFY_TLS", default = "true" },
  { key = "SEQ_MEM_REMOTE_FALLBACK_PATH", default = "~/.local/state/seq/remote_fallback/seq_mem_fallback.jsonl" },
  { key = "SEQ_MEM_LOCAL_TAIL_ENABLED", default = "true" },
  { key = "SEQ_MEM_LOCAL_TAIL_MAX_BYTES", default = "52428800" },
  { key = "SEQ_MEM_REMOTE_DRAIN_BATCH_SIZE", default = "1000" },
  { key = "SEQ_MEM_REMOTE_DRAIN_MAX_BATCHES", default = "50" },
  { key = "SEQ_AGENT_QA_CLAUDE_DIR", default = "~/.claude/projects" },
  { key = "SEQ_AGENT_QA_CODEX_DIR", default = "~/.codex/sessions" },
  { key = "SEQ_AGENT_QA_STATE", default = "~/.local/state/seq/agent_qa_ingest_state.json" },
  { key = "SEQ_AGENT_QA_PIDFILE", default = "~/.local/state/seq/agent_qa_ingest.pid" },
  { key = "SEQ_AGENT_QA_LOG", default = "~/code/seq/cli/cpp/out/logs/agent_qa_ingest.log" },
  { key = "SEQ_AGENT_QA_ZVEC_JSONL", default = "~/repos/alibaba/zvec/data/agent_qa.jsonl" },
  { key = "SEQ_AGENT_QA_POLL_SECONDS", default = "1.0" },
  { key = "SEQ_AGENT_QA_RESCAN_SECONDS", default = "15.0" },
  { key = "SEQ_AGENT_QA_FLUSH_EVERY", default = "10" },
  { key = "SEQ_AGENT_QA_MAX_TEXT_CHARS", default = "8000" },
  { key = "SEQ_AGENT_QA_INCLUDE_TEXT", default = "true" },
  { key = "SEQ_NEXT_TYPE_TAP_LOG", default = "/tmp/cgeventtap.log" },
  { key = "SEQ_NEXT_TYPE_TAP_BIN", default = "~/code/seq/cli/cpp/out/bin/seq-cgeventtap-headless" },
  { key = "SEQ_NEXT_TYPE_OUT", default = "~/repos/ClickHouse/ClickHouse/user_files/seq_mem.jsonl" },
  { key = "SEQ_NEXT_TYPE_STATE", default = "~/.local/state/seq/next_type_key_capture_state.json" },
  { key = "SEQ_NEXT_TYPE_PIDFILE", default = "~/.local/state/seq/next_type_key_capture.pid" },
  { key = "SEQ_NEXT_TYPE_LOG", default = "~/code/seq/cli/cpp/out/logs/next_type_key_capture.log" },
  { key = "SEQ_NEXT_TYPE_POLL_SECONDS", default = "0.25" },
  { key = "SEQ_NEXT_TYPE_BATCH_SIZE", default = "64" },
  { key = "SEQ_NEXT_TYPE_FLUSH_MS", default = "1500" },
  { key = "SEQ_NEXT_TYPE_TAP_RESTART_COOLDOWN_S", default = "60" },
  { key = "SEQ_NEXT_TYPE_SOURCE", default = "cgeventtap" },
  { key = "SEQ_NEXT_TYPE_LAUNCH_TAP", default = "true" },
  { key = "SEQ_NEXT_TYPE_SESSION_ID", default = "" },
  { key = "SEQ_NEXT_TYPE_PROJECT_PATH", default = "" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_INBOX", default = "~/Library/Application Support/Lin/intent-inbox.jsonl" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_STATE", default = "~/.local/state/seq/next_type_predictor_state.json" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_MODEL", default = "~/.local/state/seq/next_type_predictor_model.json" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_PIDFILE", default = "~/.local/state/seq/next_type_predictor.pid" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_LOG", default = "~/code/seq/cli/cpp/out/logs/next_type_predictor.log" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_POLL_SECONDS", default = "0.20" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_SAVE_INTERVAL_SECONDS", default = "20" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_COOLDOWN_MS", default = "1200" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_TTL_MS", default = "12000" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_MIN_PREFIX", default = "2" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_MIN_TOKEN_COUNT", default = "2" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_MIN_BIGRAM_COUNT", default = "2" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_MAX_VOCAB", default = "12000" },
  { key = "SEQ_NEXT_TYPE_PREDICTOR_EMIT_SEQ_EVENTS", default = "true" },
  { key = "SEQ_NEXT_TYPE_ACCEPT_MAX_AGE_MS", default = "15000" },
  { key = "SEQ_NEXT_TYPE_ACCEPT_MIN_SCORE", default = "1" },
  { key = "SEQ_NEXT_TYPE_CONTEXT_STATE", default = "~/.local/state/seq/next_type_context_probe_state.json" },
  { key = "SEQ_NEXT_TYPE_CONTEXT_PIDFILE", default = "~/.local/state/seq/next_type_context_probe.pid" },
  { key = "SEQ_NEXT_TYPE_CONTEXT_LOG", default = "~/code/seq/cli/cpp/out/logs/next_type_context_probe.log" },
  { key = "SEQ_NEXT_TYPE_CONTEXT_POLL_SECONDS", default = "3.0" },
  { key = "SEQ_NEXT_TYPE_PHRASES_OUT", default = "~/.local/state/seq/next_type_phrases.jsonl" },
  { key = "SEQ_NEXT_TYPE_DATASET_DIR", default = "~/.local/state/seq/next_type_dataset" },
  { key = "SEQ_NEXT_TYPE_PRIME_RL_ENV_DATA", default = "~/repos/PrimeIntellect-ai/prime-rl/examples/flow_rise/environment_next_type/data/next_type_phrases.jsonl" },
  { key = "SEQ_NEXT_TYPE_MIN_BURST_CHARS", default = "3" },
  { key = "SEQ_NEXT_TYPE_CONTEXT_WINDOW_MS", default = "10000" },
  { key = "SEQ_KAR_SIGNAL_STATE", default = "~/.local/state/seq/kar_signal_state.json" },
  { key = "SEQ_KAR_SIGNAL_PIDFILE", default = "~/.local/state/seq/kar_signal.pid" },
  { key = "SEQ_KAR_SIGNAL_LOG", default = "~/code/seq/cli/cpp/out/logs/kar_signal_capture.log" },
  { key = "SEQ_KAR_SIGNAL_POLL_SECONDS", default = "0.5" },
  { key = "SEQ_KAR_SIGNAL_OUTCOME_WINDOW_MS", default = "2200" },
  { key = "SEQ_KAR_SIGNAL_OVERRIDE_WINDOW_MS", default = "1200" },
  { key = "SEQ_SIGNAL_WATCHDOG_STATE", default = "~/.local/state/seq/signal_watchdog_state.json" },
  { key = "SEQ_SIGNAL_WATCHDOG_PIDFILE", default = "~/.local/state/seq/signal_watchdog.pid" },
  { key = "SEQ_SIGNAL_WATCHDOG_LOG", default = "~/code/seq/cli/cpp/out/logs/signal_watchdog.log" },
  { key = "SEQ_SIGNAL_WATCHDOG_REPORT", default = "~/.local/state/seq/signal_watchdog_report.json" },
  { key = "SEQ_SIGNAL_WATCHDOG_INTERVAL_SECONDS", default = "900" },
  { key = "SEQ_SIGNAL_WATCHDOG_LOOKBACK_HOURS", default = "24" },
  { key = "SEQ_SIGNAL_WATCHDOG_TAIL_BYTES", default = "20971520" },
  { key = "SEQ_SIGNAL_WATCHDOG_MIN_KAR_INTENTS", default = "20" },
  { key = "SEQ_SIGNAL_WATCHDOG_MIN_KAR_LINK_RATE", default = "0.75" },
  { key = "SEQ_SIGNAL_WATCHDOG_EMIT_EVENT", default = "true" },
  { key = "SEQ_SIGNAL_WATCHDOG_AUTO_REMEDIATE", default = "true" },
  { key = "SEQ_SIGNAL_WATCHDOG_REMEDIATE_WITH_LAUNCHD", default = "true" },
  { key = "SEQ_SIGNAL_WATCHDOG_REMEDIATE_COOLDOWN_SECONDS", default = "120" },
  { key = "SEQ_SIGNAL_WATCHDOG_LABEL_NEXT_TYPE", default = "dev.nikiv.seq-capture.next-type" },
  { key = "SEQ_SIGNAL_WATCHDOG_LABEL_KAR_SIGNAL", default = "dev.nikiv.seq-capture.kar-signal" },
  { key = "SEQ_SIGNAL_WATCHDOG_LABEL_AGENT_QA", default = "dev.nikiv.seq-capture.agent-qa" },
  { key = "SEQ_SIGNAL_WATCHDOG_SNAPSHOT_ENABLED", default = "true" },
  { key = "SEQ_SIGNAL_WATCHDOG_SNAPSHOT_DIR", default = "~/.local/state/seq/checkpoints" },
  { key = "SEQ_SIGNAL_WATCHDOG_SNAPSHOT_INTERVAL_MINUTES", default = "30" },
  { key = "SEQ_SIGNAL_WATCHDOG_SNAPSHOT_KEEP", default = "48" },
  { key = "SEQ_SIGNAL_WATCHDOG_SNAPSHOT_TAIL_BYTES", default = "1048576" },
  { key = "SEQ_SIGNAL_WATCHDOG_SEQ_TRACE", default = "~/repos/ClickHouse/ClickHouse/user_files/seq_trace.jsonl" },
  { key = "SEQ_CAPTURE_LAUNCHD_LABEL_PREFIX", default = "dev.nikiv.seq-capture" },
  { key = "SEQ_HEALTH_REPORT", default = "~/.local/state/seq/seq_health_report.json" },
  { key = "SEQ_HEALTH_LOOKBACK_HOURS", default = "24" },
  { key = "SEQ_HEALTH_TAIL_BYTES", default = "20971520" },
  { key = "SEQ_HEALTH_MIN_NEXT_TYPE", default = "1" },
  { key = "SEQ_HEALTH_MIN_KAR_INTENT", default = "0" },
  { key = "SEQ_HEALTH_MIN_KAR_OUTCOME", default = "0" },
  { key = "SEQ_HEALTH_MIN_AGENT_QA", default = "1" },
  { key = "SEQ_HEALTH_MIN_KAR_LINK_RATE", default = "0.75" },
  { key = "SEQ_HEALTH_WATCHDOG_MAX_AGE_MINUTES", default = "30" },
  { key = "SEQ_HEALTH_REPAIR_WAIT_S", default = "1.0" },
  { key = "SEQD_LAUNCHD_LABEL", default = "dev.nikiv.seqd" },
  { key = "KAR_SIGNAL_OUT", default = "~/repos/laude-institute/harbor/data/kar_signal/latest" },
  { key = "KAR_SIGNAL_SUMMARY", default = "~/repos/laude-institute/harbor/data/kar_signal/latest/summary.json" },
  { key = "KAR_SIGNAL_MAX_AGE_HOURS", default = "168" },
  { key = "KAR_SIGNAL_MIN_INTENTS", default = "300" },
  { key = "KAR_SIGNAL_MIN_JOINED", default = "250" },
  { key = "KAR_SIGNAL_MIN_LINK_RATE", default = "0.80" },
  { key = "KAR_SIGNAL_MAX_ACTION_DOMINANCE", default = "0.65" },
  { key = "KAR_SIGNAL_MIN_OVERRIDES", default = "10" },
  { key = "KAR_SIGNAL_MIN_FAILUREISH", default = "30" },
  { key = "ROUTER_SIGNAL_OUT", default = "~/repos/laude-institute/harbor/data/router_signal/latest" },
  { key = "ROUTER_SIGNAL_SUMMARY", default = "~/repos/laude-institute/harbor/data/router_signal/latest/summary.json" },
  { key = "ROUTER_SIGNAL_MAX_AGE_HOURS", default = "168" },
  { key = "ROUTER_SIGNAL_MIN_DECISIONS", default = "500" },
  { key = "ROUTER_SIGNAL_MIN_JOINED", default = "400" },
  { key = "ROUTER_SIGNAL_MIN_LINK_RATE", default = "0.80" },
  { key = "ROUTER_SIGNAL_MAX_TASK_DOMINANCE", default = "0.55" },
  { key = "ROUTER_SIGNAL_MIN_OVERRIDES", default = "20" },
  { key = "ROUTER_SIGNAL_MIN_FAILUREISH", default = "60" },
  { key = "SEQ_RL_NEXT_RUN_REPORT", default = "~/.local/state/seq/rl_next_run_prep_report.json" },
  { key = "SEQ_EVERRUNS_MAPLE_LOCAL_ENDPOINT", default = "http://ingest.maple.localhost/v1/traces" },
  { key = "SEQ_EVERRUNS_MAPLE_LOCAL_INGEST_KEY", default = "" },
  { key = "SEQ_EVERRUNS_MAPLE_HOSTED_ENDPOINT", default = "https://ingest.1focus.ai/v1/traces" },
  { key = "SEQ_EVERRUNS_MAPLE_HOSTED_INGEST_KEY", default = "" },
  { key = "SEQ_EVERRUNS_MAPLE_SERVICE_NAME", default = "seq-everruns-bridge" },
  { key = "SEQ_EVERRUNS_MAPLE_SERVICE_VERSION", default = "" },
  { key = "SEQ_EVERRUNS_MAPLE_ENV", default = "local" },
  { key = "SEQ_EVERRUNS_MAPLE_SCOPE_NAME", default = "seq_everruns_bridge" },
  { key = "SEQ_EVERRUNS_MAPLE_QUEUE_CAPACITY", default = "4096" },
  { key = "SEQ_EVERRUNS_MAPLE_MAX_BATCH_SIZE", default = "128" },
  { key = "SEQ_EVERRUNS_MAPLE_FLUSH_INTERVAL_MS", default = "50" },
  { key = "SEQ_EVERRUNS_MAPLE_CONNECT_TIMEOUT_MS", default = "400" },
  { key = "SEQ_EVERRUNS_MAPLE_REQUEST_TIMEOUT_MS", default = "800" },
]
